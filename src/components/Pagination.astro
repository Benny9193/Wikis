---
interface Props {
  currentPage: number;
  totalPages: number;
  baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

// Generate page numbers to show
const getPageNumbers = () => {
  const pages: (number | string)[] = [];
  const maxVisible = 5;

  if (totalPages <= maxVisible + 2) {
    // Show all pages if small enough
    for (let i = 1; i <= totalPages; i++) {
      pages.push(i);
    }
  } else {
    // Always show first page
    pages.push(1);

    if (currentPage > 3) {
      pages.push('...');
    }

    // Pages around current
    const start = Math.max(2, currentPage - 1);
    const end = Math.min(totalPages - 1, currentPage + 1);

    for (let i = start; i <= end; i++) {
      pages.push(i);
    }

    if (currentPage < totalPages - 2) {
      pages.push('...');
    }

    // Always show last page
    pages.push(totalPages);
  }

  return pages;
};

const pageNumbers = getPageNumbers();
const prevUrl = currentPage > 1 ? `${baseUrl}${currentPage - 1 === 1 ? '' : `/${currentPage - 1}`}` : null;
const nextUrl = currentPage < totalPages ? `${baseUrl}/${currentPage + 1}` : null;
---

{totalPages > 1 && (
  <nav class="pagination" aria-label="Page navigation">
    <div class="pagination-info">
      Page {currentPage} of {totalPages}
    </div>

    <div class="pagination-controls">
      {prevUrl ? (
        <a href={prevUrl} class="pagination-btn pagination-prev" aria-label="Previous page">
          &larr; Prev
        </a>
      ) : (
        <span class="pagination-btn pagination-prev disabled" aria-disabled="true">
          &larr; Prev
        </span>
      )}

      <div class="pagination-pages">
        {pageNumbers.map(page => (
          typeof page === 'number' ? (
            page === currentPage ? (
              <span class="pagination-page current" aria-current="page">{page}</span>
            ) : (
              <a href={`${baseUrl}${page === 1 ? '' : `/${page}`}`} class="pagination-page">{page}</a>
            )
          ) : (
            <span class="pagination-ellipsis">{page}</span>
          )
        ))}
      </div>

      {nextUrl ? (
        <a href={nextUrl} class="pagination-btn pagination-next" aria-label="Next page">
          Next &rarr;
        </a>
      ) : (
        <span class="pagination-btn pagination-next disabled" aria-disabled="true">
          Next &rarr;
        </span>
      )}
    </div>
  </nav>
)}

<style>
  .pagination {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-md);
    margin-top: var(--spacing-xl);
    padding-top: var(--spacing-lg);
    border-top: 1px solid var(--color-border);
  }

  .pagination-info {
    color: var(--color-text-muted);
    font-size: 0.875rem;
  }

  .pagination-controls {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
  }

  .pagination-btn {
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--color-bg-darker);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    color: var(--color-text);
    text-decoration: none;
    font-size: 0.875rem;
    transition: all 0.2s;
  }

  .pagination-btn:hover:not(.disabled) {
    background: var(--color-pip-green);
    color: var(--color-bg-dark);
    border-color: var(--color-pip-green);
    text-decoration: none;
  }

  .pagination-btn.disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .pagination-pages {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
  }

  .pagination-page {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 36px;
    height: 36px;
    padding: 0 var(--spacing-sm);
    background: var(--color-bg-darker);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    color: var(--color-text);
    text-decoration: none;
    font-size: 0.875rem;
    transition: all 0.2s;
  }

  .pagination-page:hover:not(.current) {
    background: var(--color-pip-green);
    color: var(--color-bg-dark);
    border-color: var(--color-pip-green);
    text-decoration: none;
  }

  .pagination-page.current {
    background: var(--color-pip-green);
    color: var(--color-bg-dark);
    border-color: var(--color-pip-green);
    font-weight: bold;
  }

  .pagination-ellipsis {
    padding: 0 var(--spacing-xs);
    color: var(--color-text-muted);
  }

  @media (max-width: 600px) {
    .pagination-pages {
      display: none;
    }
  }
</style>
